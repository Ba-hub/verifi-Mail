# Made By : Ghosthub

import base64
exec(base64.b64decode('IyEvdXNyL2Jpbi9weXRob24KIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIwojIFNjcmlwdCA6IHZlcnlmaS1tQGlsICAgICAgICAgICAgICAgICAjCiMgICAgSk9CIDogVmVyaWZ5IEVtYWlsIEFkZHJlc3MgICAgICAgICMKIyBDb2RlZEJ5OiBnaG9zdGh1YiAoYkBiQHkpICAgICAgICAgICAgIwojIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjCiMKI0NvbG9ycyMKIwpyZD0iXDAzM1sxOzMxbSIKZ3I9IlwwMzNbMTszMm0iCnlsPSJcMDMzWzE7MzNtIgp3aT0iXDAzM1sxOzM3bSIKIwojCiNMaWJyYXJpZXMjCnRyeToKICAgIGZyb20gb3MgaW1wb3J0IHN5c3RlbSBhcyBzeSwgcGF0aDsgc3koImNsc3x8Y2xlYXIiKTtpbXBvcnQgcmVxdWVzdHMsc29ja2V0LG9wdHBhcnNlLHJlCmV4Y2VwdCBJbXBvcnRFcnJvcjoKICAgIHByaW50KHJkKyJcblsiK3lsKyIhIityZCsiXSAiK3lsKyJFcnJvcjogUGxlYXNlIEluc3RhbGwgWyAiK2dyKyJSZXF1ZXN0cyIreWwrIiBdICIrcmQrIiAhISEiK3dpKQogICAgcHJpbnQod2krIlsiK2dyKyIqIit3aSsiXSBVc2UgVGhpcyBDb21tYW5kOj4iK2dyKyIgcGlwIGluc3RhbGwgcmVxdWVzdHMiK3dpKQogICAgZXhpdCgxKQojCiMgQ2hlY2sgSW50ZXJuZXQgQ29ubmVjdGlvbiAjCmRlZiBjbmV0KCk6CiAgICB0cnk6CiAgICAgICAgaXAgPSBzb2NrZXQuZ2V0aG9zdGJ5bmFtZSgid3d3Lmdvb2dsZS5jb20iKQogICAgICAgIGNvbiA9IHNvY2tldC5jcmVhdGVfY29ubmVjdGlvbigoaXAsIDgwKSwgMikKICAgICAgICByZXR1cm4gVHJ1ZQogICAgZXhjZXB0IHNvY2tldC5lcnJvcjoKICAgICAgICBwYXNzCiAgICByZXR1cm4gRmFsc2UKIwojQ2hlY2stRW1haWwtVmFsaXRlaW9uIwpjaGVja21haWwgPSBsYW1iZGEgZW1haWw6IGFueShyZS5tYXRjaChyZWcsIGVtYWlsKSBmb3IgcmVnIGluIFtyIihcV3xeKVtcdy4rXC1dKkBnbWFpbFwuY29tKFxXfCQpIiwgciJbYS16QS1aMC05X1wuK10rQGhvdG1haWwoXC5bYS16XXsyLDN9KXsxLDJ9Il0pCiMKI0NoZWNrLUVtYWlsLUZ1bmN0aW9uIwojCmRlZiBJU01BSUwoZW1haWwpOgogICAgdHJ5OgogICAgICAgIGRhdGEgPSB7ImVtYWlsIjogZW1haWx9CiAgICAgICAgaGVhZGVycyA9IHsnVXNlci1BZ2VudCc6J01vemlsbGEvNS4wIChXaW5kb3dzIE5UIDYuMTsgV09XNjQpIEFwcGxlV2ViS2l0LzUzNC4yNCAoS0hUTUwsIGxpa2UgR2Vja28pIFJvY2tNZWx0LzAuOS41OC40OTQgQ2hyb21lLzExLjAuNjk2LjcxIFNhZmFyaS81MzQuMjQnfQogICAgICAgIHJlc3BvbnNlID0gcmVxdWVzdHMucG9zdCgiaHR0cHM6Ly92ZXJpZnllbWFpbGFkZHJlc3MuY29tL3Jlc3VsdCIsIGhlYWRlcnM9aGVhZGVycywgZGF0YT1kYXRhKS50ZXh0CiAgICAgICAgaWYgImlzIHZhbGlkIiBpbiByZXNwb25zZToKICAgICAgICAgICAgcHJpbnQod2krIlsiK2dyKyIrIit3aSsiXSBFbWFpbFsiK2dyK2VtYWlsK3dpKyJdIFNUQVRVU1siK2dyKyIgRk9VTkQgIit3aSsiXSIpCiAgICAgICAgZWxzZToKICAgICAgICAgICAgI3RyeSBhbm90aGVyIHdlYnNpdGUKICAgICAgICAgICAgcmVzcG9uc2UgPSByZXF1ZXN0cy5wb3N0KCJodHRwczovL3d3dy5pbmZvYnlpcC5jb20vdmVyaWZ5ZW1haWxhY2NvdW50LnBocCIsIGhlYWRlcnM9aGVhZGVycywgZGF0YT1kYXRhKS50ZXh0CiAgICAgICAgICAgIGlmICJFbWFpbCBhY2NvdW50IGV4aXN0cy4iIGluIHJlc3BvbnNlOgogICAgICAgICAgICAgICAgcHJpbnQod2krIlsiK2dyKyIrIit3aSsiXSBFbWFpbFsiK2dyK2VtYWlsK3dpKyJdIFNUQVRVU1siK2dyKyIgRk9VTkQgIit3aSsiXSIpCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICBwcmludCh5bCsiWyIrcmQrIi0iK3lsKyJdIEVtYWlsWyIrcmQrZW1haWwreWwrIl0gU1RBVFVTWyIrcmQrIiBOT1RGRCAiK3lsKyJdIit3aSkKICAgIGV4Y2VwdChLZXlib2FyZEludGVycnVwdCxFT0ZFcnJvcik6CiAgICAgICAgcHJpbnQod2krIiAiKQogICAgICAgIGV4aXQoMSkKCnBhcnNlID0gb3B0cGFyc2UuT3B0aW9uUGFyc2VyKCIiIgpVU0FHRTogcHl0aG9uMiB2ZXJ5ZmktbUBpbC5weSBbT1BUSU9OUy4uLl0KLS0tLS0tLS0tLS0tLQpPUFRJT05TOgogICAgICAgfAogICAgfC0tLS0tLS0tICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgIHwgIC1zIC0tc2luZ2xlIFtFbWFpbF0gICAgICAgICAgICAgICAgIDo6PiBDaGVjayBTaW5nbGUgRW1haWwgICAKICAgIHwtLS0tLS0tLQogICAgfCAgLW0gLS1tYW55ICAgW0VtYWlsLEVtYWlsMixldGNdICAgICAgOjo+IENoZWNrIE1hbnkgRW1haWxzCiAgICB8LS0tLS0tLS0KICAgIHwgIC1mIC0tZmlsZSAgIFtFbWFpbF9maWxlXSAgICAgICAgICAgIDo6PiBDaGVjayBBbGwgRW1haWxzIEZyb20gRmlsZQotLS0tLS0tLS0tLS0tCkV4YW1wbGVzOgogICAgICAgIHwKICAgICB8LS0tLS0tLS0KICAgICB8IHB5dGhvbjIgdmVyeWZpLW1AaWwucHkgLXMgYWJjQGdtYWlsLmNvbQogICAgIHwtLS0tLS0tLQogICAgIHwgcHl0aG9uMiB2ZXJ5ZmktbUBpbC5weSAtbSBhYmNAZ21haWwuY29tLGFiYzEyQGdtYWlsLmNvbSxhYmMxMjNAaG90bWFpbC5jb20KICAgICB8LS0tLS0tLS0KICAgICB8IHB5dGhvbjIgdmVyeWZpLW1AaWwucHkgLWYgZW1haWxzLnR4dAogICAgIHwtLS0tLS0tLQoKICAgICAgICAgICAgICAgICAgICAgICAgLjo6IFZhbGlkIEVtYWlscyBUbyBDaGVjayA6Oi4KICAgICAgICAgICAgICAgICAgICAgICAgWyBHbWFpbC5jb20gLCwsIGhvdG1haWwuY29tIF0KCiIiIix2ZXJzaW9uPSIyLjAiKQpkZWYgTWFpbigpOgogICAgcGFyc2UuYWRkX29wdGlvbignLXMnLCctUycsJy0tc2luZ2xlJywnLS1TSU5HTEUnLCBkZXN0PSJTbWFpbCIsdHlwZT0ic3RyaW5nIikKICAgIHBhcnNlLmFkZF9vcHRpb24oJy1tJywnLW0nLCctLW1hbnknLCctLU1BTlknLCBkZXN0PSJNbWFpbCIsdHlwZT0ic3RyaW5nIikKICAgIHBhcnNlLmFkZF9vcHRpb24oJy1mJywnLUYnLCctLWZpbGUnLCctLUZJTEUnLCBkZXN0PSJGbWFpbCIsdHlwZT0ic3RyaW5nIikKICAgIChvcHQsYXJncykgPSBwYXJzZS5wYXJzZV9hcmdzKCkKICAgIGlmIG9wdC5TbWFpbCAhPU5vbmU6CiAgICAgICAgaWYgY25ldCgpICE9VHJ1ZToKICAgICAgICAgICAgcHJpbnQocmQrIlxuWyIreWwrIiEiK3JkKyJdIit5bCsiIEVycm9yOiBQbGVhc2UgQ2hlY2sgWW91ciBJbnRlcm5ldCBDb25uZWN0aW9uICIrcmQrIiEhISIrd2kpCiAgICAgICAgICAgIGV4aXQoMSkKICAgICAgICBlbWFpbCA9IG9wdC5TbWFpbAogICAgICAgIGlmIG5vdCBlbWFpbC5zdHJpcCgpIG9yICJAIiBub3QgaW4gZW1haWwuc3RyaXAoKSBvciBub3QgY2hlY2ttYWlsKGVtYWlsLnN0cmlwKCkpOmV4aXQoeWwrIlsiK3JkKyIhIit5bCsiXSIrcmQrIiBFUlJPUiIreWwrIjogRW1haWxbIityZCtlbWFpbC5zdHJpcCgpK3lsKyJdIFNUQVRVU1siK3JkKyIgSW52YWxpZCAiK3lsKyJdIit3aSkKICAgICAgICBlbWFpbCA9IGVtYWlsLnN0cmlwKCkKICAgICAgICBwcmludChncisiWyIreWwrIn4iK2dyKyJdIit5bCsiIENoZWNraW5nLi4uLlxuIit3aSkKICAgICAgICBJU01BSUwoZW1haWwpCiAgICBlbGlmIG9wdC5NbWFpbCAhPU5vbmU6CiAgICAgICAgaWYgY25ldCgpICE9VHJ1ZToKICAgICAgICAgICAgcHJpbnQocmQrIlxuWyIreWwrIiEiK3JkKyJdIit5bCsiIEVycm9yOiBQbGVhc2UgQ2hlY2sgWW91ciBJbnRlcm5ldCBDb25uZWN0aW9uICIrcmQrIiEhISIrd2kpCiAgICAgICAgICAgIGV4aXQoMSkKICAgICAgICBtYW55X2VtYWlsID0gb3B0Lk1tYWlsCiAgICAgICAgcHJpbnQoZ3IrIlsiK3lsKyJ+IitncisiXSIreWwrIiBDaGVja2luZy4uLi5cbiIrd2kpCiAgICAgICAgaWYgJywnIGluIG1hbnlfZW1haWw6CiAgICAgICAgICAgIGVtYWlscyA9IG1hbnlfZW1haWwuc3BsaXQoIiwiKQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHByaW50KHlsKyJcblsiK3JkKyIhIit5bCsiXSBFcnJvcjogUGxlYXNlIFVzZVsgIit3aSsiLCIreWwrIiBdIFRvIFNwbGl0IFRoZSBFbWFpbHMiK3JkKyIgISEhIit3aSkKICAgICAgICAgICAgZXhpdCgxKQogICAgICAgIHRyeToKICAgICAgICAgICAgZm9yIGVtYWlsIGluIGVtYWlsczoKICAgICAgICAgICAgICAgIGlmIG5vdCBlbWFpbC5zdHJpcCgpOiBjb250aW51ZQogICAgICAgICAgICAgICAgaWYgIkAiIG5vdCBpbiBlbWFpbC5zdHJpcCgpIG9yIG5vdCBjaGVja21haWwoZW1haWwuc3RyaXAoKSk6cHJpbnQoeWwrIlsiK3JkKyIhIit5bCsiXSIrcmQrIiBFUlJPUiIreWwrIjogRW1haWxbIityZCtlbWFpbC5zdHJpcCgpK3lsKyJdIFNUQVRVU1siK3JkKyIgSW52YWxpZCAiK3lsKyJdIit3aSk7Y29udGludWUKICAgICAgICAgICAgICAgIGVtYWlsID0gZW1haWwuc3RyaXAoKQogICAgICAgICAgICAgICAgSVNNQUlMKGVtYWlsKQogICAgICAgIGV4Y2VwdCAoS2V5Ym9hcmRJbnRlcnJ1cHQsRU9GRXJyb3IpOgogICAgICAgICAgICBwcmludCh3aSsiICIpCiAgICAgICAgICAgIGV4aXQoMSkKICAgICAgICAgICAgCiAgICBlbGlmIG9wdC5GbWFpbCAhPU5vbmU6CiAgICAgICAgZW1haWxzX2ZpbGUgPSBvcHQuRm1haWwKICAgICAgICBwcmludChncisiWyIreWwrIn4iK2dyKyJdIit5bCsiIENoZWNraW5nLi4uLlxuIit3aSkKICAgICAgICBpZiBub3QgcGF0aC5pc2ZpbGUoZW1haWxzX2ZpbGUpOgogICAgICAgICAgICBwcmludCh5bCsiXG5bIityZCsiISIreWwrIl0iK3JkKyIgRXJyb3I6Iit5bCsiIE5vIFN1Y2ggRmlsZTogWyAiK3JkK2VtYWlsc19maWxlK3lsKyIgXSIrcmQrIiAhISEiK3dpKQogICAgICAgICAgICBwcmludCh3aSsiWyIreWwrIiEiK3dpKyJdIit5bCsiIFBsZWFzZToiK3dpKyIgQ2hlY2sgWW91ciBFbWFpbHMgRmlsZSBQYXRoLiIreWwrIiEiK3dpKQogICAgICAgICAgICBleGl0KDEpCiAgICAgICAgdHJ5OgogICAgICAgICAgICB3aXRoIG9wZW4oZW1haWxzX2ZpbGUpIGFzIGZvcDoKICAgICAgICAgICAgICAgIGZvciBlbWFpbCBpbiBmb3A6CiAgICAgICAgICAgICAgICAgICAgaWYgbm90IGVtYWlsLnN0cmlwKCk6Y29udGludWUKICAgICAgICAgICAgICAgICAgICBpZiBub3QgIkAiIGluIGVtYWlsIG9yIG5vdCBjaGVja21haWwoZW1haWwuc3RyaXAoKSk6IHByaW50KHlsKyJbIityZCsiISIreWwrIl0iK3JkKyIgRVJST1IiK3lsKyI6IEVtYWlsWyIrcmQrZW1haWwuc3RyaXAoKSt5bCsiXSBTVEFUVVNbIityZCsiIEludmFsaWQgIit5bCsiXSIrd2kpO2NvbnRpbnVlCiAgICAgICAgICAgICAgICAgICAgZW1haWwgPSBlbWFpbC5zdHJpcCgpCiAgICAgICAgICAgICAgICAgICAgSVNNQUlMKGVtYWlsKQogICAgICAgICAgICBmb3AuY2xvc2UoKQogICAgICAgIGV4Y2VwdCAoS2V5Ym9hcmRJbnRlcnJ1cHQsRU9GRXJyb3IpOgogICAgICAgICAgICBwcmludChyZCsiXG5bIit5bCsiISIreWwrIl0gQWJvcnRpbmcuLi4iK3JkKyIhIikKICAgICAgICAgICAgZXhpdCgxKQogICAgZWxzZToKICAgICAgICBwcmludChwYXJzZS51c2FnZSkKICAgICAgICBleGl0KDEpCgppZiBfX25hbWVfXz09Il9fbWFpbl9fIjoKICAgIE1haW4oKQo='))